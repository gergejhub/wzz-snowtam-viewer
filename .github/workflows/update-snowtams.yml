name: Update SNOWTAM JSON

on:
workflow_dispatch:
schedule:
# GitHub Actions minimum is ~5 minutes, but external sites may block aggressive polling.
# This runs every 10 minutes.
- cron: "*/10 * * * *"

permissions:
contents: write

concurrency:
group: snowtam-update
cancel-in-progress: true

jobs:
update:
runs-on: ubuntu-latest
steps:
- name: Checkout
uses: actions/checkout@v4

- name: Setup Python
uses: actions/setup-python@v5
with:
python-version: "3.11"

- name: Install deps
run: |
python -m pip install --upgrade pip
pip install -r scripts/requirements.txt

- name: Generate data/airports.json and data/snowtam_status.json
run: |
python scripts/update_snowtams.py

- name: Commit changes (if any)
uses: EndBug/add-and-commit@v9
with:
add: "data/*.json"
message: "chore(data): update SNOWTAM status"
